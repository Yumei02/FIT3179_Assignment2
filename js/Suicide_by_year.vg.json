{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "data": {"url": "https://raw.githubusercontent.com/Yumei02/FIT3179_Assignment2/main/suicide_deaths_dataset.csv"},
    "encoding": {
      "color": {"field": "State", "legend": {"offset": 80}},
      "x": {"field": "NumberofSuicideDeaths", "type": "quantitative"},
      "y": {
        "field": "State",
        "type": "nominal",
        "sort": {"field": "NumberofSuicideDeaths", "order": "descending"},
        "axis": false
      },
      "time": {
        "field": "Year",
        "scale": {"type": "band", "range": [0, 10000]},
        "key": {"field": "State"},
        "rescale": true
      }
    },
    "params": [
      {
        "name": "Year",
        "select": {"type": "point", "on": "timer"},
        "bind": {"input": "range", "min": 2012, "max": 2021, "step": 1}
      }
    ],
    "transform": [
      {"calculate": "+substring(datum.Year,0,4)", "as": "Year"},
      {"calculate": "+datum.NumberofSuicideDeaths", "as": "NumberofSuicideDeaths"},
      {
        "sort": [
          {"field": "Year", "order": "descending"},
          {"field": "NumberofSuicideDeaths", "order": "descending"}
        ],
        "window": [{"op": "rank", "as": "rank"}],
        "groupby": ["Year"]
      },
      {"filter": {"param": "Year"}},
      {"filter": {"field": "rank", "lte": 10}}
    ],
    "layer": [
      {"mark": "bar"},
      {
        "mark": {
          "type": "text",
          "align": "left",
          "baseline": "top",
          "dx": 3,
          "dy": 4
        },
        "encoding": {"text": {"field": "State"}}
      }
    ]
  }